#+title: Analysis
#+author: Arumoy Shome
#+date: [2022-08-29 Mon]
#+options: toc:t
#+toc: tables
#+html_head: <link rel="stylesheet" href="main.css">


In this document we present the analysis of the results collected in
this study.

We consider each protected attribute for each dataset as a separate
analysis. For each analysis, we wish to answer the following
questions:

1. Is the model making unfair predictions?
2. If so, do the model-centric fairness metrics *indicate* this unfair
   behaviour?
3. If so, do the data-centric fairness metrics *explain* this unfair
   behaviour?

* Summary of results
Following table presents a concise summary of the results obtained in
this study.

#+caption: Summary of Results
#+name: tab-summary-results
|---------+---------------------+-------+----+----+----|
| dataset | protected attribute | model | Q1 | Q2 | Q3 |
|---------+---------------------+-------+----+----+----|
| adult   | sex                 | lr    | Y  | Y  | Y  |
| adult   | sex                 | dt    | Y  | Y  | Y  |
| adult   | race                | lr    | Y  | Y  | Y  |
| adult   | race                | dt    | Y  | Y  | N  |
|---------+---------------------+-------+----+----+----|
| compas  | sex                 | lr    | Y  | Y  | Y  |
| compas  | sex                 | dt    |    |    |    |
| compas  | race                | lr    |    |    |    |
| compas  | race                | dt    |    |    |    |
|---------+---------------------+-------+----+----+----|
| bank    | age                 | lr    |    |    |    |
| bank    | age                 | dt    |    |    |    |
|---------+---------------------+-------+----+----+----|
| german  | sex                 | lr    |    |    |    |
| german  | sex                 | dt    |    |    |    |
| german  | age                 | lr    |    |    |    |
| german  | age                 | dt    |    |    |    |
|---------+---------------------+-------+----+----+----|
| gpa     | race                | lr    |    |    |    |
| gpa     | race                | dt    |    |    |    |
|---------+---------------------+-------+----+----+----|

* DONE adult-sex-lr
:PROPERTIES:
:CUSTOM_ID: sec-adult-sex-lr
:END:
:LOGBOOK:
- State "DONE"       from "TODO"       [2022-08-29 Mon 15:33]
:END:
** Is the model unfair?

#+caption: CM for logisticregression
#+name: fig-adult-sex-lr-cm-rate
[[file:adult_heatmap_prot-sex_mod-lr_cm-rate.png]]

As seen from Figure [[fig-adult-sex-lr-cm-rate]], the FNs for the
unprivileged group is higher than the FNs for the privileged group.
This indicates that the model is unfair towards the unprivileged
group. Given an example from the unprivileged group, the model is more
likely to incorrectly classify it as a negative example.

** Do the model-centric metrics indicate unfairness?

#+caption: Disparate Impact for models
#+name: fig-adult-sex-mod-disparate-impact
[[file:adult_barplot_prot-sex_mod-all_disparate-impact.png]]

#+caption: Precision-recall for logisticregression
#+name: fig-adult-sex-lr-pre-rec
[[file:adult_barplot_prot-sex_mod-lr_acc-pre-rec-f1.png]]

From Figure [[fig-adult-sex-mod-disparate-impact]], the disparate impact
for the logisticregression model is $<1$ which indicates that the
unprivileged group is at a disadvantage.

From Figure [[fig-adult-sex-lr-pre-rec]], the recall for the unprivileged
group is lower than that of the privileged group. This indicates that
when identifying positive examples, the model performs worse for the
unprivileged group.

** Do the data-centric metrics explain unfairness?

#+caption: Disparate Impact for data
#+name: fig-adult-sex-data-disparate-impact
[[file:adult_barplot_prot-sex_mod-none_disparate-impact.png]]

From Figure [[fig-adult-sex-data-disparate-impact]], the disparate impact
across all subsets of the data is $<1$ which indicates that the
unprivileged group is at a disadvantage.

#+caption: Base rate
#+name: fig-adult-sex-base-rate
[[file:adult_barplot_prot-sex_base-rate.png]]

From Figure [[fig-adult-sex-base-rate]]:

#+name: eq-base-rate-unpriv
\begin{equation}
\text{base rate for unprivileged group} = P(Y=1 | D=\text{unprivileged}) = 0.120 \\
\implies P(Y=0 | D=\text{unprivileged}) = 1 - P(Y=1 | D=\text{unprivileged}) = 0.88
\end{equation}

Similarly,

#+name: eq-base-rate-priv
\begin{equation}
\text{base rate for privileged group} = P(Y=1 | D=\text{privileged}) = 0.310 \\
\implies P(Y=0 | D=\text{privileged}) = 1 - P(Y=1 | D=\text{privileged}) = 0.69
\end{equation}

Consider that we pick a random example from the dataset each from the
privileged & unprivileged group. From Equations [[eq-base-rate-unpriv]] &
[[eq-base-rate-priv]], it is more likely that the example from the
unprivileged group is negative compared to the privileged group.

Thus for the unprivileged group, the model is more biased towards the
negative class compared to the privileged group, which examples why
the recall for the unprivileged group is lower than that of the
privileged group.

* DONE adult-sex-dt
:PROPERTIES:
:CUSTOM_ID: sec-adult-sex-dt
:END:
:LOGBOOK:
- State "DONE"       from "TODO"       [2022-08-29 Mon 15:49]
:END:
** Is the model unfair?

#+caption: CM for decisiontreeclassifier
#+name: fig-adult-sex-dt-cm-rate
[[file:adult_heatmap_prot-sex_mod-dt_cm-rate.png]]

As seen from Figure [[fig-adult-sex-dt-cm-rate]], the FNs for the
unprivileged group is higher than the FNs for the privileged group.
This indicates that the model is unfair towards the unprivileged
group. Similar bias as seen in Section [[#sec-adult-sex-lr]].

** Do the model-centric metrics indicate unfairness?

#+caption: Precision-recall for decisiontreeclassifier
#+name: fig-adult-sex-dt-pre-rec
[[file:adult_barplot_prot-sex_mod-dt_acc-pre-rec-f1.png]]

From Figure [[fig-adult-sex-mod-disparate-impact]], the disparate impact
for the decisiontreeclassifier model is $<1$ which indicates that the
unprivileged group is at a disadvantage.

From Figure [[fig-adult-sex-dt-pre-rec]], both the precision & recall for
the unprivileged group is lower than that of the privileged group.
This indicates that when identifying positive examples, the model
performs worse for the unprivileged group. This is corroborated by
Figure [[fig-adult-sex-dt-cm-rate]] where the model does not identify the
TPs for the unprivileged group as well as the privileged group. The
model also has higher FNs for the unprivileged group vs. privileged
group.

** Do the data-centric metrics explain unfairness?

From Figure [[fig-adult-sex-data-disparate-impact]], the disparate impact
across all subsets of the data is $<1$ which indicates that the
unprivileged group is at a disadvantage.

Similar explaination for precision-recall as Section [[#sec-adult-sex-lr]].

* DONE adult-race-lr
:PROPERTIES:
:CUSTOM_ID: sec-adult-race-lr
:END:

** Is the model unfair?

#+caption: CM for logisticregression
#+name: fig-adult-race-lr-cm-rate
[[file:adult_heatmap_prot-race_mod-lr_cm-rate.png]]

From Figure [[fig-adult-race-lr-cm-rate]], the model is biased to the
negative class. This bias is more in the case of unprivileged group
vs. privileged group, similar to what we see in Section
[[#sec-adult-sex-lr]].

** Do the model-centric metrics indicate unfairness?

#+caption: Disparate Impact for models
#+name: fig-adult-race-mod-disparate-impact
[[file:adult_barplot_prot-race_mod-all_disparate-impact.png]]

From Figure [[fig-adult-race-mod-disparate-impact]], the disparate impact
is $<1$ indicating the unprivileged group is at a disadvantage.

#+caption: Precision-recall for logisticregression
#+name: fig-adult-race-lr-pre-rec
[[file:adult_barplot_prot-race_mod-lr_acc-pre-rec-f1.png]]

From figure [[fig-adult-race-lr-pre-rec]], the precision and recall for
the unprivileged group is lower than the privileged group. This is
explainable using the same logic seen in Section [[#sec-adult-sex-lr]].

** Do the data-centric metrics explain unfairness?

#+caption: Disparate Impact for data
#+name: fig-adult-race-data-disparate-impact
[[file:adult_barplot_prot-race_mod-none_disparate-impact.png]]

From Figure [[fig-adult-race-data-disparate-impact]], the disparate impact
across all subsets is $<1$ indicating that the unprivileged group is
at a disadvantage.

#+caption: Base rate
#+name: fig-adult-sex-base-rate
[[file:adult_barplot_prot-race_base-rate.png]]

Similar explaination for precision-recall as [[#sec-adult-sex-lr]]

* DONE adult-race-dt
:PROPERTIES:
:CUSTOM_ID: sec-adult-race-dt
:END:

** Is the model unfair?

#+caption: CM for decisiontreeclassifier
#+name: fig-adult-race-dt-cm-rate
[[file:adult_heatmap_prot-race_mod-dt_cm-rate.png]]

The model is biased to the negative class however the bias is similar
for both privileged & unprivileged groups.

** Do the model-centric metrics indicate unfairness?

From Figure [[fig-adult-race-mod-disparate-impact]], the disparate impact
is $<1$ but higher than the logisticregression model. This indicates
that the decisiontreeclassifier is fairer compared to the
logisticregression. This is corroborated by the confusion matrix as
seen in Figure [[fig-adult-race-dt-cm-rate]].

#+caption: Precision-recall for decisiontreeclassifier
#+name: fig-adult-race-dt-pre-rec
[[file:adult_barplot_prot-race_mod-dt_acc-pre-rec-f1.png]]

The recall for the privileged & unprivileged group are similar
indicating the model is not biased towards a particular group.

- [ ] why is the precision of the privileged group higher than the
  unprivileged group? the TPR & FPR are very similar for the
  groups so precision should be similar as well?

** Do the data-centric metrics explain unfairness?

In this case, the data metrics indicate that the unprivileged group
are at an advantage. However the decisiontreeclassifier does not show
this bias.

* DONE compas-sex-lr
:PROPERTIES:
:CUSTOM_ID: sec-compas-sex-lr
:END:

** Is the model unfair?

#+caption: CM for logisticregression
#+name: fig-compas-sex-lr-cm-rate
[[file:compas_heatmap_prot-sex_mod-lr_cm-rate.png]]

From Figure [[fig-compas-sex-lr-cm-rate]], the model is biased to the
positive class as the FPR is high. The FPR for the privileged group is
higher than the unprivileged group. This means that the privileged
group is at an advantage as the model is more likely to classify an
example from the privileged group as positive.

** Do the model-centric metrics indicate unfairness?

#+caption: Disparate Impact for models
#+name: fig-compas-sex-mod-disparate-impact
[[file:compas_barplot_prot-sex_mod-all_disparate-impact.png]]

#+caption: Precision-recall for logisticregression
#+name: fig-compas-sex-lr-pre-rec
[[file:compas_barplot_prot-sex_mod-lr_acc-pre-rec-f1.png]]

From Figure [[fig-compas-sex-mod-disparate-impact]], the disparate impact
for the logisticregression model is $<1$ which indicates that the
unprivileged group is at a disadvantage.

From Figure [[fig-compas-sex-lr-pre-rec]], the precision & recall for the
unprivileged group is lower than that of the privileged group. This
indicates that when identifying positive examples, the model performs
worse for the unprivileged group.

** Do the data-centric metrics explain unfairness?

#+caption: Disparate Impact for data
#+name: fig-compas-sex-data-disparate-impact
[[file:compas_barplot_prot-sex_mod-none_disparate-impact.png]]

From Figure [[fig-compas-sex-data-disparate-impact]], the disparate impact
across all subsets of the data is $<1$ which indicates that the
unprivileged group is at a disadvantage.

- [ ] small catch here, the acceptable range for disparate impact is
  $[0.8, 1.1]$.

#+caption: Base rate
#+name: fig-adult-sex-base-rate
[[file:adult_barplot_prot-sex_base-rate.png]]

Similar explaination for precision-recall as Section
[[#sec-adult-sex-lr]].


* TODO compas-sex-dt

* TODO compas-race-lr

* TODO compas-race-dt

* TODO bank-age-lr

* TODO bank-age-dt

* TODO german-sex-lr

* TODO german-sex-dt

* TODO german-age-lr

* TODO german-age-dt

* TODO gpa-race-lr

* TODO gpa-race-dt
